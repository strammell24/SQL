# In this City Bike Lanes project, I inserted the City Bike Lanes data into a table I created. 
# I then used a CTE to help see which bike lanes were the safest bike lanes based on their ratings being 4.0 or above: 

WITH average_safety_rating_CTE As (
SELECT c. street, 
AVG (c.safetyrating) as  rating
FROM CityBikeLanes as c
GROUP BY c.street)

SELECT street, rating, 'Safe Lane' as label
FROM average_safety_rating_CTE 
WHERE rating >=4.0
GROUP BY street;

# Next, I used a window function to help analyze if it is recommended for a safety bike lane to stay or to leave: 

SELECT street, safetyrating, AVG (safetyrating) OVER (Partition by street)  as "Average_safety_rating", 
CASE WHEN AVG(safetyrating) OVER (Partition by street) >= 4 THEN "Leave As-Is"
     WHEN AVG(safetyrating) OVER (Partition by street) < 2.5 THEN "Remove"
     ELSE "Improvements Needed"
     END AS "Recommendation"
FROM CityBikeLanes;
